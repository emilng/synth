!function e(t,n,i){function a(u,r){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!r&&c)return c(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return a(n?n:e)},l,l.exports,e,t,n,i)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<i.length;u++)a(i[u]);return a}({1:[function(e){var t=e("./audio/generateNoteMappings.js"),n=e("./audio/updateOctave.js"),i=e("./ui/initKeyboard.js"),a=e("./ui/clickHandlers.js"),o=e("./ui/keyHandlers"),u=e("./ui/updateEnvelope.js"),r=e("./ui/updateKeyboard.js"),c=e("./ui/drawVisualizer.js"),s=function(e){var t=c(e),n=function(){e.notesChanged&&(r(e),e.notesChanged=!1),e.envelopeChanged&&(u(e),e.envelopeChanged=!1),t(),requestAnimationFrame(n)};return n},l=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext;var e=new AudioContext,u=["A","W","S","E","D","F","T","G","Y","H","U","J","K","O","L","P",";","'"],r=u.map(function(){return!1}),c=e.createGain();c.gain.value=.5;var l=e.createDynamicsCompressor(),d=e.createAnalyser();c.connect(l),l.connect(d),d.connect(e.destination);var v={audio:{context:e,gainNodes:[],masterGain:c,analyser:d,octave:3,notes:null,envelope:{delayTime:0,attackTime:.1,decayTime:.1,sustainTime:0,releaseTime:.1,delayValue:0,attackValue:1,decayValue:.5,sustainValue:.5,releaseValue:0},activeNotes:r},ui:{keyChars:u,keyboard:null,keyDimensions:null,keyOffsets:[],envelope:{width:400,height:150,minSpacing:20,maxSpacing:60,marginY:20,marginX:25,releaseMin:295}},notesChanged:!0,envelopeChanged:!0};v.audio.notes=t(),v.ui.keyboard=i(v),a.noteClick(v),a.octaveClick(v),n(v,0);var m=s(v);requestAnimationFrame(m),document.addEventListener("mouseup",a.noteOff(v)),document.addEventListener("keydown",o.keyDown(v)),document.addEventListener("keyup",o.keyUp(v))};window.addEventListener("load",l,!1)},{"./audio/generateNoteMappings.js":2,"./audio/updateOctave.js":5,"./ui/clickHandlers.js":6,"./ui/drawVisualizer.js":7,"./ui/initKeyboard.js":8,"./ui/keyHandlers":9,"./ui/updateEnvelope.js":10,"./ui/updateKeyboard.js":11}],2:[function(e,t){var n=function(){for(var e=1.059463094359,t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],n=440,i=-4,a=3,o=21+a,u=[],r=0;88>r;){var c=r+a,s=c%12,l=Math.floor(c/12),d=n*Math.pow(e,12*i+c),v=r+o;u.push({frequency:d,midi:v,name:t[s],octave:l}),r++}return u};t.exports=n},{}],3:[function(e,t){var n=function(e,t){var n,i=e.audio,a=i.context.currentTime,o=void 0!==t&&i.activeNotes[t]===!0;o?(n=i.gainNodes[t],n.gain.cancelScheduledValues(a),n.gain.setTargetAtTime(0,a,.1),i.activeNotes[t]=!1):i.activeNotes=i.activeNotes.map(function(e,o){return e&&(n=i.gainNodes[o],n.gain.cancelScheduledValues(a),n.gain.setTargetAtTime(0,a,.1),i.activeNotes[t]=!1),!1}),e.notesChanged=!0};t.exports=n},{}],4:[function(e,t){var n=function(e,t){var n=e.audio,i=n.octave;t>=n.activeNotes.length&&(i++,t-=n.activeNotes.length);var a=n.activeNotes[t];if(!a){var o=n.context.currentTime;n.activeNotes[t]=!0;var u=n.notes,r=12*i+t;if(r<u.length-1){var c=u[r],s=n.context.createOscillator(),l=n.context.createGain();n.gainNodes[t]=l,s.connect(l),l.connect(n.masterGain),s.type=s.SINE,s.noteIndex=r,s.frequency.value=c.frequency,s.start(o),l.gain.cancelScheduledValues(o),l.gain.setValueAtTime(0,o),l.gain.setTargetAtTime(1,o,.1),e.notesChanged=!0}}};t.exports=n},{}],5:[function(e,t){var n=function(e,t){var n=e.audio;n.octave=Math.max(0,Math.min(6,n.octave+t));var i=document.getElementById("octave-display");i.innerHTML="Octave "+n.octave};t.exports=n},{}],6:[function(e,t,n){var i=e("../audio/noteOn.js"),a=e("../audio/noteOff.js"),o=e("../audio/updateOctave.js"),u=function(e){for(var t=function(e,t){return function(){i(e,t)}},n=0;18>n;){var a=document.getElementById("key-"+n);a.addEventListener("mousedown",t(e,n)),n++}},r=function(e){var t=function(e,t){return function(){o(e,t)}},n=document.getElementById("octave-down");n.addEventListener("click",t(e,-1));var i=document.getElementById("octave-up");i.addEventListener("click",t(e,1))},c=function(e){return function(){a(e)}};n.noteClick=u,n.octaveClick=r,n.noteOff=c},{"../audio/noteOff.js":3,"../audio/noteOn.js":4,"../audio/updateOctave.js":5}],7:[function(e,t){var n=function(e){var t=document.getElementById("visualizer"),n=e.audio.analyser;n.fftSize=2048;var i=n.fftSize,a=new Uint8Array(i),o=t.getContext("2d"),u=t.width,r=t.height,c=function(){n.getByteTimeDomainData(a),o.clearRect(0,0,u,r),o.fillStyle="#EEE",o.fillRect(0,0,u,r),o.beginPath();for(var e=u*(1/i),t=0,c=0;i>c;c++){var s=a[c]/128,l=s*r/2;0===c?o.moveTo(t,l):o.lineTo(t,l),t+=e}o.lineTo(u,r/2),o.stroke()};return c};t.exports=n},{}],8:[function(e,t){var n=function(e){var t=(document.getElementById("full-keyboard"),document.createElement("canvas"));t.width=400,t.height=30;var n=t.getContext("2d"),i=e.ui.keyDimensions={black:{width:4,height:14},white:{width:6,height:22}},a=Math.round(i.white.width/2);n.strokeStyle="#000",n.lineWidth=1,n.fillStyle="#000";for(var o=87,u=0,r=e.audio.notes,c=e.ui.keyOffsets,s=0;o>s;s++)1===r[s].name.length?(c.push(u),u+=i.white.width):c.push(u-a+1);return c.map(function(e,t){1===r[t].name.length&&n.strokeRect(e,0,i.white.width,i.white.height)}),c.map(function(e,t){2===r[t].name.length&&n.fillRect(e,0,i.black.width,i.black.height)}),n.getImageData(0,0,t.width,t.height)};t.exports=n},{}],9:[function(e,t,n){var i=e("../audio/noteOn.js"),a=e("../audio/noteOff.js"),o=e("../audio/updateOctave.js"),u=function(e,t){return keyChar=186===t||59===t?";":222===t||39===t?"'":String.fromCharCode(t),e.ui.keyChars.indexOf(keyChar)},r=function(e){return function(t){var n=t.keyCode;if(!(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)){var a=u(e,n);a>-1&&(i(e,a),t.preventDefault());var r=String.fromCharCode(n);"Z"===r?o(e,-1):"X"===r&&o(e,1)}}},c=function(e){return function(t){var n=u(e,t.keyCode);n>-1&&a(e,n)}};n.keyUp=c,n.keyDown=r},{"../audio/noteOff.js":3,"../audio/noteOn.js":4,"../audio/updateOctave.js":5}],10:[function(e,t){var n=function(e){var t=e.audio.envelope,n=e.ui.envelope,i=document.getElementById("svg-envelope"),a=i.getBoundingClientRect(),o=(i.getAttributeNS(null,"width"),i.getAttributeNS(null,"height")),u=n.releaseMin,r=n.minSpacing,c=n.maxSpacing,s=n.marginX,l=n.marginY,d=o-l,v=o-2*l,m=["delay","attack","decay","sustain","release"],f=function(e,t,n){return Math.min(Math.max(e,t),n)},y=function(n){var o=function(){i.style.cursor="",document.removeEventListener("mousemove",u),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",o)},u=function(i){var o=(parseInt(n.timeRect.getAttributeNS(null,"x"),10),i.clientX-a.left),u=f(o-(n.previousX+r),0,c),s=u/c;t[n.name+"Time"]=s,e.envelopeChanged=!0},s=function(i){var a=(parseInt(n.valueTimeRect.getAttributeNS(null,"y"),10),f(i.clientY-l,0,v)),o=1-a/v;t[n.name+"Value"]=o,("sustain"===n.name||"decay"===n.name)&&(t.decayValue=o,t.sustainValue=o),u(i),e.envelopeChanged=!0},d=function(){i.style.cursor="ew-resize",document.addEventListener("mousemove",u),document.addEventListener("mouseup",o)},m=function(){i.style.cursor="sustain"===n.name?"ns-resize":"move",document.addEventListener("mousemove",s),document.addEventListener("mouseup",o)},y=function(){""===i.style.cursor&&(n.timeRect.style.cursor="ew-resize")},g=function(){""===i.style.cursor&&(n.timeRect.style.cursor="")},h=function(){""===i.style.cursor&&(n.valueTimeRect.style.cursor="sustain"===n.name?"ns-resize":"move")},p=function(){""===i.style.cursor&&(n.valueTimeRect.style.cursor="")};"sustain"!==n.name&&(n.timeRect.addEventListener("mousedown",d),n.timeRect.addEventListener("mouseover",y),n.timeRect.addEventListener("mouseleave",g)),n.valueTimeRect.addEventListener("mousedown",m),n.valueTimeRect.addEventListener("mouseover",h),n.valueTimeRect.addEventListener("mouseleave",p)},g=m.reduce(function(e,t){var n={timeLine:document.getElementById("envelope-"+t+"-time"),valueLine:document.getElementById("envelope-"+t+"-value"),label:document.getElementById("envelope-"+t+"-label"),timeRect:document.getElementById("envelope-"+t+"-time-rect"),valueTimeRect:document.getElementById("envelope-"+t+"-value-time-rect"),value:t+"Value",time:t+"Time",name:t,previousX:0};return y(n),e.push(n),e},[]),h=d-t.delayValue*v,p=s,k=function(e,t,n,i,a){e.setAttributeNS(null,"x1",t),e.setAttributeNS(null,"y1",n),e.setAttributeNS(null,"x2",i),e.setAttributeNS(null,"y2",a)},E=function(e,t,n){e.setAttributeNS(null,"x",t),e.setAttributeNS(null,"y",n)},w=function(e,t,n,i,a){e.setAttributeNS(null,"x",t),e.setAttributeNS(null,"y",n),e.setAttributeNS(null,"width",i),e.setAttributeNS(null,"height",a)};g.forEach(function(e){var n=d-t[e.value]*v,i=p+r+t[e.time]*c;e.previousX=p,i="sustain"===e.name?u:i,k(e.valueLine,p,h,i,n),k(e.timeLine,i,0,i,o),E(e.label,p+3,d+12),w(e.timeRect,i-5,0,10,o),w(e.valueTimeRect,i-5,n-5,10,10),p=i,h=n})};t.exports=n},{}],11:[function(e,t){var n=function(e){var t=e.audio,n=e.ui,i=document.getElementById("full-keyboard"),a=i.getContext("2d");a.putImageData(n.keyboard,0,0);e.keys;a.fillStyle="rgba(140,140,140,0.8)",t.activeNotes.map(function(e,i){var o=document.getElementById("key-"+i),u=n.keyOffsets[12*t.octave+i],r=t.notes[12*t.octave+i],c=1===r.name.length?"white":"black";e?(a.fillRect(u,0,n.keyDimensions[c].width,n.keyDimensions[c].height),o.setAttribute("class","down-"+c+"-key")):o.setAttribute("class",c+"-key")})};t.exports=n},{}]},{},[1]);
//# sourceMappingURL=synth.min.js.map