!function e(t,n,a){function i(r,c){if(!n[r]){if(!t[r]){var u="function"==typeof require&&require;if(!c&&u)return u(r,!0);if(o)return o(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){var n=t[r][1][e];return i(n?n:e)},d,d.exports,e,t,n,a)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<a.length;r++)i(a[r]);return i}({1:[function(){var e=function(){for(var e=1.059463094359,t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],n=440,a=-4,i=3,o=21+i,r=[],c=0;88>c;){var u=c+i,s=u%12,d=Math.floor(u/12),l=n*Math.pow(e,12*a+u),f=c+o;r.push({frequency:l,midi:f,name:t[s],octave:d}),c++}return r},t=function(e){var t=(document.getElementById("full-keyboard"),document.createElement("canvas"));t.setAttribute("width",400),t.setAttribute("height",30);var n=t.getContext("2d"),a=e.ui.keyDimensions={black:{width:4,height:14},white:{width:6,height:22}},i=Math.round(a.white.width/2);n.strokeStyle="#000",n.lineWidth=1,n.fillStyle="#000";for(var o=87,r=0,c=e.sound.notes,u=e.ui.keyOffsets,s=0;o>s;s++)1===c[s].name.length?(u.push(r),r+=a.white.width):u.push(r-i+1);return u.map(function(e,t){1===c[t].name.length&&n.strokeRect(e,0,a.white.width,a.white.height)}),u.map(function(e,t){2===c[t].name.length&&n.fillRect(e,0,a.black.width,a.black.height)}),n.getImageData(0,0,t.width,t.height)},n=function(e){for(var t=function(e,t){return function(){i(e,t)}},n=0;18>n;){var a=document.getElementById("key-"+n);a.addEventListener("mousedown",t(e,n)),n++}},a=function(e){var t=function(e,t){return function(){r(e,t)}},n=document.getElementById("octave-down");n.addEventListener("click",t(e,-1));var a=document.getElementById("octave-up");a.addEventListener("click",t(e,1))},i=function(e,t){var n=e.sound,a=n.octave;t>=n.activeNotes.length&&(a++,t-=n.activeNotes.length);var i=n.activeNotes[t];if(!i){var o=n.context.currentTime;n.activeNotes[t]=!0;var r=n.notes,c=12*a+t;if(c<r.length-1){var u=r[c],s=n.context.createOscillator(),d=n.context.createGain();n.gainNodes[t]=d,s.connect(d),d.connect(n.masterGain),s.type=s.SINE,s.noteIndex=c,s.frequency.value=u.frequency,s.start(o),d.gain.cancelScheduledValues(o),d.gain.setValueAtTime(0,o),d.gain.setTargetAtTime(1,o,.1),e.notesChanged=!0}}},o=function(e,t){var n=e.sound,a=n.context.currentTime,i=void 0!==t&&n.activeNotes[t]===!0;if(i){var o=n.gainNodes[t];o.gain.cancelScheduledValues(a),o.gain.setTargetAtTime(0,a,.1),n.activeNotes[t]=!1,e.notesChanged=!0}else n.activeNotes=n.activeNotes.map(function(e,i){if(e){var o=n.gainNodes[i];o.gain.cancelScheduledValues(a),o.gain.setTargetAtTime(0,a,.1),n.activeNotes[t]=!1}return!1}),e.notesChanged=!0},r=function(e,t){var n=e.sound;n.octave=Math.max(0,Math.min(6,n.octave+t));var a=document.getElementById("octave-display");a.innerHTML="Octave "+n.octave},c=function(e){return function(){o(e)}},u=function(e,t){return keyChar=186===t||59===t?";":222===t||39===t?"'":String.fromCharCode(t),e.ui.keyChars.indexOf(keyChar)},s=function(e){return function(t){var n=t.keyCode;if(!(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)){var a=u(e,n);a>-1&&(i(e,a),t.preventDefault());var o=String.fromCharCode(n);"Z"===o?r(e,-1):"X"===o&&r(e,1)}}},d=function(e){return function(t){var n=u(e,t.keyCode);n>-1&&o(e,n)}},l=function(e){var t=e.sound,n=e.ui,a=document.getElementById("full-keyboard"),i=a.getContext("2d");i.putImageData(n.keyboard,0,0);e.keys;i.fillStyle="rgba(140,140,140,0.8)",t.activeNotes.map(function(e,a){var o=document.getElementById("key-"+a),r=n.keyOffsets[12*t.octave+a],c=t.notes[12*t.octave+a],u=1===c.name.length?"white":"black";e?(i.fillRect(r,0,n.keyDimensions[u].width,n.keyDimensions[u].height),o.setAttribute("class","down-"+u+"-key")):o.setAttribute("class",u+"-key")})},f=function(e){var t=e.ui.visualizer,n=e.sound.analyser;n.fftSize=2048;var a=n.fftSize,i=new Uint8Array(a),o=t.getContext("2d"),r=t.width,c=t.height,u=function(){e.notesChanged&&(l(e),e.notesChanged=!1),n.getByteTimeDomainData(i),o.clearRect(0,0,r,c),o.fillStyle="rgb(200, 200, 200)",o.fillRect(0,0,r,c),o.beginPath();for(var t=r*(1/a),s=0,d=0;a>d;d++){var f=i[d]/128,v=f*c/2;0===d?o.moveTo(s,v):o.lineTo(s,v),s+=t}o.lineTo(r,c/2),o.stroke(),requestAnimationFrame(u)};return u},v=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext;var i=new AudioContext,o=["A","W","S","E","D","F","T","G","Y","H","U","J","K","O","L","P",";","'"],u=(o.map(function(){return i.createGain()}),o.map(function(){return!1})),l=i.createGain();l.gain.value=.5;var v=i.createDynamicsCompressor(),h=i.createAnalyser();l.connect(v),v.connect(h),h.connect(i.destination);var m=document.getElementById("visualizer"),g={sound:{context:i,gainNodes:[],masterGain:l,analyser:h,octave:3,notes:null,activeNotes:u},ui:{keyChars:o,keyboard:null,keyDimensions:null,keyOffsets:[],visualizer:m},notesChanged:!0};g.sound.notes=e(),g.ui.keyboard=t(g),n(g),a(g),r(g,0);var y=f(g);requestAnimationFrame(y),document.addEventListener("mouseup",c(g)),document.addEventListener("keydown",s(g)),document.addEventListener("keyup",d(g))};window.addEventListener("load",v,!1)},{}]},{},[1]);
//# sourceMappingURL=synth.min.js.map